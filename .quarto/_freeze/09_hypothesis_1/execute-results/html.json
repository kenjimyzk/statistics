{
  "hash": "ac8655d4d1e3405d50e260ec8364ba96",
  "result": {
    "engine": "knitr",
    "markdown": "# 第9回 仮説検定 (1) {.unnumbered}\n\n![仮説検定 (1)](figure/09_hypothesis_1/infographic.png)\n\n## 裁判官になるための統計学\n\n「この新薬は効く！」\n「私の予知能力は本物だ！」\n\n世の中には、様々な主張が溢れている。しかし、科学の世界では「言った者勝ち」は通用しない。\nその主張が、たまたまの偶然なのか、それとも確かな証拠に基づいているのか。\nそれを厳格にジャッジする手続きが**仮説検定 (Hypothesis Testing)** 。\n\n仮説検定の仕組みは、**刑事裁判**にそっくりです。\n今回は、あなたが裁判官となって、「偶然かどうか」という難事件に判決を下す方法を学ぼう。\n\n## 1. 裁判の基本ルール：疑わしきは罰せず\n\n統計的検定の世界では、まず最初に「何の効果もない（無罪）」と仮定することから始めます。これを覆すだけの強力な証拠が出て初めて、「効果がある（有罪）」と認めることになる。\n\n### 登場人物（仮説）\n\n1.  **被告人：帰無仮説 ($H_0$)**\n    *   「差はない」「効果はない」という、否定したい仮説。\n    *   裁判で言えば**「被告人は無罪である」**という前提。\n2.  **検察官：対立仮説 ($H_1$)**\n    *   「差がある」「効果がある」という、証明したい仮説。\n    *   裁判で言えば**「被告人は有罪である」**という主張。\n\n検定のゴールは、**「無罪（$H_0$）と仮定するには、証拠（データ）が不自然すぎる」**ことを示し、無罪の前提を棄却すること。\n\n## 2. 証拠の評価：p値という驚き\n\n裁判官であるあなたは、提出された証拠（データ）を見て判断する。\nここで重要なのが **p値 (p-value)** 。\n\np値とは、**「もし被告人が無罪だとしたら、こんな証拠が出てくる確率はどれくらいか？」**という値。\n\n*   **p値が大きい（0.5とか）**: 「無罪の人からも、よく出る証拠だ」。\n    *   判決：無罪を棄却できない（証拠不十分）。\n*   **p値が極めて小さい（0.001とか）**: 「無罪だとしたら、こんな証拠が出るのはありえない（奇跡に近い）」。\n    *   判決：無罪ではないだろう。**有罪（有意）**！\n\n### 判決の基準：有意水準 ($\\alpha$)\n\nどこまで確率が低ければ「ありえない」と判断するのか？\nその基準を**有意水準**と呼び、通常 **5% (0.05)** に設定します。\n\n*   「無罪なのにこんな証拠が出る確率は5%未満」なら、それはもう偶然とは考えない。\n*   この基準を超えたとき、**「統計的に有意である (Statistically Significant)」** と宣言します。\n\n## 3. シミュレーション：無罪の証明\n\nt分布を使って、「無罪（偶然）」の範囲を可視化してみましょう。\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n# theme_set(theme_gray(base_family = \"HiraKakuProN-W3\")) # [対象注意] Mac用設定\n\n# t分布 (自由度9)\nx <- seq(-4, 4, length.out = 100)\ny <- dt(x, df = 9)\ndf_t <- data.frame(x, y)\n\n# 判決のライン（有意水準5%の両側）\ncritical_val <- qt(0.975, df = 9)\n\nggplot(df_t, aes(x = x, y = y)) +\n  theme_gray(base_family = \"HiraKakuProN-W3\") + # [対象注意] Mac用設定\n  geom_line() +\n  geom_area(data = filter(df_t, x > critical_val), fill = \"red\", alpha = 0.5) +\n  geom_area(data = filter(df_t, x < -critical_val), fill = \"red\", alpha = 0.5) +\n  geom_vline(xintercept = c(critical_val, -critical_val), linetype = \"dashed\") +\n  labs(title = \"有罪判決のライン (棄却域)\", x = \"検定統計量 (t値)\", y = \"確率密度\")\n```\n\n::: {.cell-output-display}\n![](09_hypothesis_1_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\n赤いエリアが「有罪（棄却域）」。データから計算したt値がここに入れば、「無罪」の前提は棄却されます。\n\n## 4. 実践：1標本のt検定\n\n実際の事件（データ）を裁いてみましょう。\n\n**事件**: あるクラス10人のテスト平均点は、全国平均の「50点」と違うのか？\n`scores <- c(55, 60, 45, 70, 58, 62, 48, 52, 65, 50)`\n\n1.  **帰無仮説 ($H_0$)**: 平均点に違いはない（$\\mu = 50$）。\n2.  **対立仮説 ($H_1$)**: 平均点に違いがある（$\\mu \\neq 50$）。\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscores <- c(55, 60, 45, 70, 58, 62, 48, 52, 65, 50)\nt.test(scores, mu = 50)\n#> \n#> \tOne Sample t-test\n#> \n#> data:  scores\n#> t = 2.5862, df = 9, p-value = 0.02939\n#> alternative hypothesis: true mean is not equal to 50\n#> 95 percent confidence interval:\n#>  50.81453 62.18547\n#> sample estimates:\n#> mean of x \n#>      56.5\n```\n:::\n\n\n**判決**:\np値は `0.02939` 。これは 0.05（5%）より小さい。\nつまり、「平均50点の集団から、偶然この点数が取れる確率は約2.9%しかない」。\n裁判官（あなた）は、「偶然にしては出来すぎている」と判断し、**帰無仮説を棄却**します。\n\n結論：**このクラスの平均点は、全国平均と有意に異なる。**\n\n## 5. 冤罪のリスク：2つの過誤\n\n裁判に誤審があるように、統計的検定にも誤りのリスクがあります。\n\n| | 被告人は無実 ($H_0$ 真) | 被告人はクロ ($H_1$ 真) |\n|---|---|---|\n| **有罪判決 ($H_0$ 棄却)** | **冤罪 (第1種の過誤)**<br>何も無いのに「ある」と言う<br>確率 $\\alpha$ (5%) | 正しい判決 |\n| **無罪判決 ($H_0$ 棄却せず)** | 正しい判決 | **取り逃がし (第2種の過誤)**<br>あるのに「ない」と言う<br>確率 $\\beta$ |\n\n我々が設定した「有意水準5%」とは、「5%の確率で冤罪（第1種の過誤）を起こすことを許容する」という宣言でもある。\nだからこそ、p値が小さいことは「絶対の真実」ではなく、「かなり確からしい」という程度の意味なのだ。\n\n## 課題\n\n1.  **Tipsデータの分析**:\n    `tips` データの `total_bill` の平均値が 20ドル と異なるかどうかを検定してください。\n    帰無仮説 $H_0$ と対立仮説 $H_1$ を数式で記述し、結果のp値に基づいて結論（棄却するか否か）を述べてください。\n\n## 練習問題\n\n### 練習1: 結論の解釈\nある検定の結果、p値が `0.08` でした。有意水準5%の場合、以下の主張は正しいですか？\n「p値 > 0.05 なので、帰無仮説は正しいと証明された。」\n\n### 練習2: サンプルサイズと有意差\n前回使用したシミュレーションコードを使い、$H_0: \\mu=50$ が誤り（真の $\\mu=52$）であるデータを生成してください。サンプルサイズ $n$ を変えたとき、p値がどう変化するか確認してください。\n\n### 練習3: 誤りの種類\n「ガンではない患者を、誤ってガンであると診断してしまう」のは、第1種の過誤ですか、第2種の過誤ですか？（帰無仮説：「ガンではない」とした場合）\n\n## まとめ\n\n| 裁判用語 | 統計用語 | 意味 |\n|---|---|---|\n| **被告人は無罪** | **帰無仮説 ($H_0$)** | 「差はない」という前提 |\n| **被告人は有罪** | **対立仮説 ($H_1$)** | 「差がある」という主張 |\n| **証拠の不自然さ** | **p値** | 無罪前提でそのデータが出る確率 |\n| **判決の基準** | **有意水準 ($\\alpha$)** | p値がこれ未満なら有罪（棄却） |\n| **冤罪** | **第1種の過誤** | 無罪なのに有罪にしてしまうミス |\n",
    "supporting": [
      "09_hypothesis_1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}