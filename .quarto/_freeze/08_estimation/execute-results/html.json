{
  "hash": "9646cefaf907f8a02d29ec702c076f27",
  "result": {
    "engine": "knitr",
    "markdown": "# 第8回 統計的推定 {.unnumbered}\n\n\n\n## 今回の目標\n\n-   点推定と区間推定の違いを理解する。\n-   信頼区間の意味を正しく理解する。\n-   Rで信頼区間を計算する。\n\n## 点推定 (Point Estimation)\n\n母数（母平均など）を一つの値でピンポイントに推定することです。\n例えば、標本平均 $\\bar{x}$ は母平均 $\\mu$ の点推定値として使われます。\n\n## 区間推定 (Interval Estimation)\n\n母数が含まれるであろう「範囲」を、ある確率（信頼係数）をもって推定することです。\n一般的に **95%信頼区間** がよく使われます。\n\n### 信頼区間の意味\n\n「95%の確率で母数がこの区間に入る」というのは少し不正確です。\n正しくは、「同じ手順で標本抽出と区間推定を100回繰り返したら、そのうち約95回の区間には母数が含まれる」という意味です。\n\nこれをシミュレーションで可視化してみましょう。\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nset.seed(123)\n\n# シミュレーション設定 {.unnumbered}\nn_sim <- 100\nn_sample <- 30\nmu <- 50\nsigma <- 10\n\n# 結果を格納するデータフレーム {.unnumbered}\nresults <- data.frame(id = 1:n_sim, lower = NA, upper = NA, hit = NA)\n\nfor (i in 1:n_sim) {\n  # 標本抽出\n  x <- rnorm(n_sample, mean = mu, sd = sigma)\n  # t検定で信頼区間を計算\n  test <- t.test(x)\n  results$lower[i] <- test$conf.int[1]\n  results$upper[i] <- test$conf.int[2]\n  # 母平均が含まれているか判定\n  results$hit[i] <- (mu >= results$lower[i] & mu <= results$upper[i])\n}\n\n# プロット {.unnumbered}\nggplot(results, aes(x = id, ymin = lower, ymax = upper, color = hit)) +\n  theme_gray(base_family = \"HiraKakuProN-W3\") +\n  geom_errorbar(width = 0.5) +\n  geom_hline(yintercept = mu, linetype = \"dashed\") +\n  labs(title = \"95%信頼区間のシミュレーション (100回)\", x = \"試行回数\", y = \"推定された区間\") +\n  scale_color_manual(values = c(\"TRUE\" = \"gray\", \"FALSE\" = \"red\"))\n```\n\n::: {.cell-output-display}\n![](08_estimation_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\n## 母平均の信頼区間（母分散が未知の場合）\n\nt分布を使って計算します。Rでは `t.test()` 関数を使うと簡単に計算できます。\n`tips` データの `total_bill` の平均値の95%信頼区間を求めてみましょう。\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nurl <- \"https://raw.githubusercontent.com/mwaskom/seaborn-data/master/tips.csv\"\ntips <- read_csv(url)\n\nt.test(tips$total_bill)\n#> \n#> \tOne Sample t-test\n#> \n#> data:  tips$total_bill\n#> t = 34.717, df = 243, p-value < 2.2e-16\n#> alternative hypothesis: true mean is not equal to 0\n#> 95 percent confidence interval:\n#>  18.66333 20.90855\n#> sample estimates:\n#> mean of x \n#>  19.78594\n```\n:::\n\n\n出力結果の `95 percent confidence interval:` の部分を見ます。\n\n```\n95 percent confidence interval:\n 18.66333 20.90855\n```\n\nこれは、「支払総額の母平均は、約18.66ドルから20.91ドルの間にあると考えられる」ことを示しています。\n\n## 母比率の信頼区間\n\n「支持率」や「喫煙率」などの割合（比率）の推定には `prop.test()` を使います。\n例：100人中60人が賛成した場合の、母集団での賛成率の95%信頼区間。\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprop.test(x = 60, n = 100)\n#> \n#> \t1-sample proportions test with continuity correction\n#> \n#> data:  60 out of 100, null probability 0.5\n#> X-squared = 3.61, df = 1, p-value = 0.05743\n#> alternative hypothesis: true p is not equal to 0.5\n#> 95 percent confidence interval:\n#>  0.4970036 0.6952199\n#> sample estimates:\n#>   p \n#> 0.6\n```\n:::\n\n\n## 課題\n\n1.  `tips` データの `tip`（チップ）について、平均値の99%信頼区間を求めてください。\n    （ヒント: `t.test()` の引数に `conf.level = 0.99` を指定します）\n",
    "supporting": [
      "08_estimation_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}