# 第5回 確率論の基礎 {.unnumbered}



## 今回の目標

-   確率変数、確率分布の意味を理解する。
-   期待値と分散の定義と意味を理解する。
-   Rを使って期待値を計算してみる。

## 確率変数と確率分布

-   **確率変数 (Random Variable)**: サイコロの目やコインの裏表のように、とる値が確率的に決まる変数のこと。通常 $X$ や $Y$ などの大文字で表します。
-   **確率分布 (Probability Distribution)**: 確率変数がどのような値をどのような確率でとるかを表したものです。

### 例：サイコロ

サイコロを1回振ったときの出る目を $X$ とすると、$X$ は $\{1, 2, 3, 4, 5, 6\}$ のいずれかの値をとります。
それぞれの目が出る確率は $1/6$ です。

Rで表してみましょう。

```{r}
x <- 1:6
prob <- rep(1/6, 6) # 1/6 を 6回繰り返す

data.frame(x, prob)
```

これをグラフ（確率分布図）にしてみましょう。

```{r}
library(tidyverse)
theme_set(theme_gray(base_family = "HiraKakuProN-W3"))

df <- data.frame(x = factor(x), prob = prob)

ggplot(df, aes(x = x, y = prob)) +
  geom_col(fill = "orange") +
  ylim(0, 0.5) +
  labs(title = "サイコロの確率分布", x = "出る目", y = "確率")
```

## 期待値 (Expected Value)

確率変数の「平均的な値」のことです。$E[X]$ と書きます。
とりうる値に、その確率を掛けて足し合わせることで計算できます。

$$ E[X] = \sum x_i P(X=x_i) $$

サイコロの期待値を計算してみましょう。



3.5 という結果になります。サイコロの目は整数ですが、平均すると3.5になるという意味です。

Rで計算してみましょう。

```{r}
# 期待値の計算
E_X <- sum(x * prob)
E_X
```

### 期待値の性質

期待値には以下のような便利な性質があります。

1.  **定数を足す**: $E[X + c] = E[X] + c$
2.  **定数を掛ける**: $E[cX] = c \cdot E[X]$
3.  **線形性**: $E[aX + bY] = aE[X] + bE[Y]$

## 分散 (Variance)

確率変数の「ばらつき」を表す指標です。$V[X]$ と書きます。
「（値 - 期待値）の2乗」の期待値として定義されます。

$$ V[X] = E[(X - E[X])^2] = \sum (x_i - E[X])^2 P(X=x_i) $$

サイコロの分散を計算してみましょう。



## 課題

1.  コインを1回投げて、表が出たら 100円、裏が出たら 0円もらえるギャンブルがあります。
    表が出る確率を 0.5、裏が出る確率を 0.5 とするとき、もらえる金額の期待値を計算してください。
2.  もし表が出る確率が 0.1、裏が出る確率が 0.9 だったら、期待値はどうなりますか？
